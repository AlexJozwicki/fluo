!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.fluo=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function d(){}d.prototype._events=void 0,d.prototype.listeners=function(a){if(!this._events||!this._events[a])return[];if(this._events[a].fn)return[this._events[a].fn];for(var b=0,c=this._events[a].length,d=new Array(c);c>b;b++)d[b]=this._events[a][b].fn;return d},d.prototype.emit=function(a,b,c,d,e,f){if(!this._events||!this._events[a])return!1;var g,h,i=this._events[a],j=arguments.length;if("function"==typeof i.fn){switch(i.once&&this.removeListener(a,i.fn,!0),j){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,b),!0;case 3:return i.fn.call(i.context,b,c),!0;case 4:return i.fn.call(i.context,b,c,d),!0;case 5:return i.fn.call(i.context,b,c,d,e),!0;case 6:return i.fn.call(i.context,b,c,d,e,f),!0}for(h=1,g=new Array(j-1);j>h;h++)g[h-1]=arguments[h];i.fn.apply(i.context,g)}else{var k,l=i.length;for(h=0;l>h;h++)switch(i[h].once&&this.removeListener(a,i[h].fn,!0),j){case 1:i[h].fn.call(i[h].context);break;case 2:i[h].fn.call(i[h].context,b);break;case 3:i[h].fn.call(i[h].context,b,c);break;default:if(!g)for(k=1,g=new Array(j-1);j>k;k++)g[k-1]=arguments[k];i[h].fn.apply(i[h].context,g)}}return!0},d.prototype.on=function(a,b,d){var e=new c(b,d||this);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},d.prototype.once=function(a,b,d){var e=new c(b,d||this,!0);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},d.prototype.removeListener=function(a,b,c){if(!this._events||!this._events[a])return this;var d=this._events[a],e=[];if(b&&(d.fn&&(d.fn!==b||c&&!d.once)&&e.push(d),!d.fn))for(var f=0,g=d.length;g>f;f++)(d[f].fn!==b||c&&!d[f].once)&&e.push(d[f]);return e.length?this._events[a]=1===e.length?e[0]:e:delete this._events[a],this},d.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[a]:this._events={},this):this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.EventEmitter=d,d.EventEmitter2=d,d.EventEmitter3=d,b.exports=d},{}],2:[function(b,c){(function(b){!function(b,d,e){d[b]=d[b]||e(),"undefined"!=typeof c&&c.exports?c.exports=d[b]:"function"==typeof a&&a.amd&&a(function(){return d[b]})}("Promise","undefined"!=typeof b?b:this,function(){"use strict";function a(a,b){m.add(a,b),l||(l=o(m.drain))}function b(a){var b,c=typeof a;return null==a||"object"!=c&&"function"!=c||(b=a.then),"function"==typeof b?b:!1}function c(){for(var a=0;a<this.chain.length;a++)d(this,1===this.state?this.chain[a].success:this.chain[a].failure,this.chain[a]);this.chain.length=0}function d(a,c,d){var e,f;try{c===!1?d.reject(a.msg):(e=c===!0?a.msg:c.call(void 0,a.msg),e===d.promise?d.reject(TypeError("Promise-chain cycle")):(f=b(e))?f.call(e,d.resolve,d.reject):d.resolve(e))}catch(g){d.reject(g)}}function e(d){var g,i,j=this;if(!j.triggered){j.triggered=!0,j.def&&(j=j.def);try{(g=b(d))?(i=new h(j),g.call(d,function(){e.apply(i,arguments)},function(){f.apply(i,arguments)})):(j.msg=d,j.state=1,j.chain.length>0&&a(c,j))}catch(k){f.call(i||new h(j),k)}}}function f(b){var d=this;d.triggered||(d.triggered=!0,d.def&&(d=d.def),d.msg=b,d.state=2,d.chain.length>0&&a(c,d))}function g(a,b,c,d){for(var e=0;e<b.length;e++)!function(e){a.resolve(b[e]).then(function(a){c(e,a)},d)}(e)}function h(a){this.def=a,this.triggered=!1}function i(a){this.promise=a,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function j(b){if("function"!=typeof b)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var d=new i(this);this.then=function(b,e){var f={success:"function"==typeof b?b:!0,failure:"function"==typeof e?e:!1};return f.promise=new this.constructor(function(a,b){if("function"!=typeof a||"function"!=typeof b)throw TypeError("Not a function");f.resolve=a,f.reject=b}),d.chain.push(f),0!==d.state&&a(c,d),f.promise},this["catch"]=function(a){return this.then(void 0,a)};try{b.call(void 0,function(a){e.call(d,a)},function(a){f.call(d,a)})}catch(g){f.call(d,g)}}var k,l,m,n=Object.prototype.toString,o="undefined"!=typeof setImmediate?function(a){return setImmediate(a)}:setTimeout;try{Object.defineProperty({},"x",{}),k=function(a,b,c,d){return Object.defineProperty(a,b,{value:c,writable:!0,configurable:d!==!1})}}catch(p){k=function(a,b,c){return a[b]=c,a}}m=function(){function a(a,b){this.fn=a,this.self=b,this.next=void 0}var b,c,d;return{add:function(e,f){d=new a(e,f),c?c.next=d:b=d,c=d,d=void 0},drain:function(){var a=b;for(b=c=l=void 0;a;)a.fn.call(a.self),a=a.next}}}();var q=k({},"constructor",j,!1);return k(j,"prototype",q,!1),k(q,"__NPO__",0,!1),k(j,"resolve",function(a){var b=this;return a&&"object"==typeof a&&1===a.__NPO__?a:new b(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");b(a)})}),k(j,"reject",function(a){return new this(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");c(a)})}),k(j,"all",function(a){var b=this;return"[object Array]"!=n.call(a)?b.reject(TypeError("Not an array")):0===a.length?b.resolve([]):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");var e=a.length,f=Array(e),h=0;g(b,a,function(a,b){f[a]=b,++h===e&&c(f)},d)})}),k(j,"race",function(a){var b=this;return"[object Array]"!=n.call(a)?b.reject(TypeError("Not an array")):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");g(b,a,function(a,b){c(b)},d)})}),j})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(a,b){var c=a("./utils"),d=a("./Publisher"),e=function(a){a=a||{},c.isObject(a)||(a={actionType:a}),d.call(this),this._isAction=!0,this.actionType="action",this.eventType="event",this.asyncResult=!!a.asyncResult,this.children=a.children||[],this.asyncResult&&this.children.push("completed","failed"),delete a.children,c.extend(this,a),this.createChildActions();var b=a.sync?this.triggerSync:this.trigger,e=b.bind(this);return e.__proto__=this,e};c.inherits(e,d),e.prototype.createChildActions=function(){for(var a=this.children,b=0;b<a.length;++b){var c=a[b];this[c]=new e({actionType:c})}},b.exports=e},{"./Publisher":6,"./utils":19}],4:[function(a,b){var c=a("./utils"),d=a("./Publisher"),e=a("./instanceJoinCreator"),f=function(){d.call(this),this.subscriptions=[]};c.inherits(f,d),f.prototype.hasListener=function(a){for(var b=this.subscriptions||[],c=0;c<b.length;++c)for(var d=[].concat(b[c].listenable),e=0;e<d.length;++e){var f=d[e];if(f===a)return!0;if(f.hasListener&&f.hasListener(a))return!0}return!1},f.prototype.listenToMany=function(a){var b=h(a);for(var d in b){var e=c.callbackName(d),f=this[e]?e:this[d]?d:void 0;if(f){var g=this[e+"Default"]||this[f+"Default"]||f;this.listenTo(b[d],f,g)}}},f.prototype.validateListening=function(a){return a===this?"Listener is not able to listen to itself":c.isFunction(a.listen)?a.hasListener&&a.hasListener(this)?"Listener cannot listen to this listenable because of circular loop":void 0:a+" is missing a listen method"},f.prototype.listenTo=function(a,b,d){c.throwIf(this.validateListening(a)),this.fetchInitialState(a,d);var e=this.subscriptions,f=a.listen(this[b]||b,this),g=function(){var a=e.indexOf(h);c.throwIf(-1===a,"Tried to remove listen already gone from subscriptions list!"),e.splice(a,1),f()},h={stop:g,listenable:a};return e.push(h),h},f.prototype.stopListeningTo=function(a){for(var b=this.subscriptions||[],d=0;d<b.length;++d){var e=b[d];if(e.listenable===a)return e.stop(),c.throwIf(-1!==b.indexOf(e),"Failed to remove listen from subscriptions list!"),!0}return!1},f.prototype.stopListeningToAll=function(){for(var a,b=this.subscriptions||[];a=b.length;)b[0].stop(),c.throwIf(b.length!==a-1,"Failed to remove listen from subscriptions list!")},f.prototype.fetchInitialState=function(a,b){"string"==typeof b&&(b=this[b]);var d=this;if(c.isFunction(b)&&c.isFunction(a.getInitialState)){var e=a.getInitialState();e&&c.isFunction(e.then)?e.then(function(){b.apply(d,arguments)}):b.call(this,e)}},f.prototype.joinTrailing=e("last"),f.prototype.joinLeading=e("first"),f.prototype.joinConcat=e("all"),f.prototype.joinStrict=e("strict");var g=function(a){for(var b={},c=a.children||[],d=0;d<c.length;++d){var e=c[d];a[e]&&(b[e]=a[e])}return b},h=function(a){var b={};for(var d in a){var e=a[d],f=g(e),i=h(f);b[d]=e;for(var j in i){var k=i[j];b[d+c.capitalize(j)]=k}}return b};b.exports=f},{"./Publisher":6,"./instanceJoinCreator":14,"./utils":19}],5:[function(a,b){var c=a("./Listener"),d=Array.prototype.slice,e=new c;e.listenTo=function(){return this.subscriptions=this.subscriptions||[],c.prototype.listenTo.apply(this,d.call(arguments))},e.componentWillUnmount=function(){this.stopListeningToAll()},b.exports=e},{"./Listener":4}],6:[function(a,b){var c=a("./utils"),d=function(){this.emitter=new c.EventEmitter,this.children=[],this.eventType="event"};d.prototype.preEmit=function(){},d.prototype.shouldEmit=function(){return!0},d.prototype.listen=function(a,b){var e=this;b=b||this;var f=function(f){var g=a.apply(b,f);if(c.isPromise(g)){var h=d.prototype.canHandlePromise.call(e);if(!h)return void console.warn("Unhandled promise for "+e.eventType);e.promise(g)}};return this.emitter.addListener(this.eventType,f),function(){e.emitter.removeListener(e.eventType,f)}},d.prototype.promise=function(a){var b=d.prototype.canHandlePromise.call(this);if(!b)throw new Error('Publisher must have "completed" and "failed" child publishers');var c=this;a.then(function(a){return c.completed.trigger(a)}),a["catch"](function(a){return c.failed.trigger(a)})},d.prototype.canHandlePromise=function(){return c.isAction(this.completed)&&c.isAction(this.failed)},d.prototype.triggerSync=function(){var a=arguments,b=this.preEmit.apply(this,a);"undefined"!=typeof b&&(a=c.isArguments(b)?b:[].concat(b)),this.shouldEmit.apply(this,a)&&this.emitter.emit(this.eventType,a)},d.prototype.trigger=function(){var a=arguments,b=this;c.nextTick(function(){b.triggerSync.apply(b,a)})},d.prototype.triggerPromise=function(){var a=d.prototype.canHandlePromise.call(this);if(!a)throw new Error('Publisher must have "completed" and "failed" child publishers');var b=this,e=arguments,f=c.createPromise(function(a,c){var d=b.completed.listen(function(b){d(),f(),a(b)}),f=b.failed.listen(function(a){d(),f(),c(a)});b.trigger.apply(b,e)});return f},b.exports=d},{"./utils":19}],7:[function(a,b){var c=a("./Publisher"),d=new c;b.exports=d},{"./Publisher":6}],8:[function(a,b){var c=a("./utils"),d=a("./Listener"),e=function(a){if(d.call(this),this.eventType="change",a&&(c.bindMethods(a,this),c.copyPropertiesOf(a,this)),this.init(),this.listenables)for(var b=[].concat(this.listenables),e=0;e<b.length;++e)this.listenToMany(b[e])};c.inherits(e,d),e.prototype.init=function(){},b.exports=e},{"./Listener":4,"./utils":19}],9:[function(a,b){var c=a("./utils"),d=a("./Listener");b.exports=function(a,b){return{getInitialState:function(){if(c.isFunction(a.getInitialState)){if("undefined"==typeof b)return a.getInitialState();var d={};return d[b]=a.getInitialState(),d}return{}},componentDidMount:function(){if(this.__listener=new d,c.link(this.__listener,this),"undefined"==typeof b)this.listenTo(a,this.setState);else{var e=this;this.listenTo(a,function(a){var c={};c[b]=a,e.setState(c)})}},componentWillUnmount:function(){this.__listener.stopListeningToAll()}}}},{"./Listener":4,"./utils":19}],10:[function(a,b){var c=a("./utils"),d=a("./Listener");b.exports=function(a,b,e){return e=c.isFunction(b)?b:e,{getInitialState:function(){if(c.isFunction(a.getInitialState)){if(c.isFunction(b))return e.call(this,a.getInitialState());var d=e.call(this,a.getInitialState());return d?c.object([b],[d]):{}}return{}},componentDidMount:function(){this.__listener=new d,c.link(this.__listener,this);var f=this,g=function(a){if(c.isFunction(b))f.setState(e.call(f,a));else{var d=e.call(f,a);f.setState(c.object([b],[d]))}};this.listenTo(a,g)},componentWillUnmount:function(){this.__listener.stopListeningToAll()}}}},{"./Listener":4,"./utils":19}],11:[function(a,b){var c=a("./Action"),d=a("./keep"),e=function(a){a=a||{};var b=new c(a);return d.createdActions.push(b),b};b.exports=e},{"./Action":3,"./keep":15}],12:[function(a,b){var c=a("./Store"),d=a("./keep");b.exports=function(a){var b=new c(a);return d.createdStores.push(b),b}},{"./Store":8,"./keep":15}],13:[function(a,b,c){var d=a("./utils"),e=a("./staticJoinCreator");c.Action=a("./Action"),c.Listener=a("./Listener"),c.Publisher=a("./Publisher"),c.Store=a("./Store"),c.createAction=a("./createAction"),c.createStore=a("./createStore"),c.connect=a("./connect"),c.connectFilter=a("./connectFilter"),c.ListenerMixin=a("./ListenerMixin"),c.PublisherMixin=a("./PublisherMixin"),c.listenTo=a("./listenTo"),c.listenToMany=a("./listenToMany"),c.joinTrailing=c.all=e("last"),c.joinLeading=e("first"),c.joinStrict=e("strict"),c.joinConcat=e("all"),c.createActions=function(a){var b={};for(var e in a){var f=a[e],g=d.isObject(f)?e:f;b[g]=c.createAction(f)}return b},c.setEventEmitter=function(b){var c=a("./utils");c.EventEmitter=b},c.setPromise=function(b){var c=a("./utils");c.Promise=b},c.setPromiseFactory=function(b){var c=a("./utils");c.createPromise=b},c.nextTick=function(b){var c=a("./utils");c.nextTick=b},c.__keep=a("./keep"),Function.prototype.bind||console.error("Function.prototype.bind not available. ES5 shim required. https://github.com/jankuca/fluo#es5")},{"./Action":3,"./Listener":4,"./ListenerMixin":5,"./Publisher":6,"./PublisherMixin":7,"./Store":8,"./connect":9,"./connectFilter":10,"./createAction":11,"./createStore":12,"./keep":15,"./listenTo":16,"./listenToMany":17,"./staticJoinCreator":18,"./utils":19}],14:[function(a,b){function c(a,b,c){return function(){var d,e=c.subscriptions,f=e?e.indexOf(a):-1;for(g.throwIf(-1===f,"Tried to remove join already gone from subscriptions list!"),d=0;d<b.length;++d)b[d]();e.splice(f,1)}}function d(a){a.listenablesEmitted=new Array(a.numberOfListenables),a.args=new Array(a.numberOfListenables)}function e(a,b){return function(){var c=h.call(arguments);if(b.listenablesEmitted[a])switch(b.strategy){case"strict":throw new Error("Strict join failed because listener triggered twice.");case"last":b.args[a]=c;break;case"all":b.args[a].push(c)}else b.listenablesEmitted[a]=!0,b.args[a]="all"===b.strategy?[c]:c;f(b)}}function f(a){for(var b=0;b<a.numberOfListenables;++b)if(!a.listenablesEmitted[b])return;a.callback.apply(a.listener,a.args),d(a)}var g=a("./utils"),h=Array.prototype.slice;b.exports=function(a){return function(){g.throwIf(arguments.length<3,"Cannot create a join with less than 2 listenables!");var b,f=h.call(arguments),i=f.pop(),j=f.length,k={numberOfListenables:j,callback:this[i]||i,listener:this,strategy:a},l=[];for(b=0;j>b;++b)g.throwIf(this.validateListening(f[b]));for(b=0;j>b;++b)l.push(f[b].listen(e(b,k),this));d(k);var m={listenable:f};return m.stop=c(m,l,this),this.subscriptions=(this.subscriptions||[]).concat(m),m}}},{"./utils":19}],15:[function(a,b,c){c.createdStores=[],c.createdActions=[],c.reset=function(){for(;c.createdStores.length;)c.createdStores.pop();for(;c.createdActions.length;)c.createdActions.pop()}},{}],16:[function(a,b){var c=a("./utils"),d=a("./Listener");b.exports=function(a,b,e){return{componentDidMount:function(){this.__listener=new d,c.link(this.__listener,this),this.listenTo(a,b,e)},componentWillUnmount:function(){this.__listener.stopListeningToAll()}}}},{"./Listener":4,"./utils":19}],17:[function(a,b){var c=a("./utils"),d=a("./Listener");b.exports=function(a){return{componentDidMount:function(){this.__listener=new d,c.link(this.__listener,this),this.listenToMany(a)},componentWillUnmount:function(){this.__listener.stopListeningToAll()}}}},{"./Listener":4,"./utils":19}],18:[function(a,b){var c=a("./createStore"),d=Array.prototype.slice,e={strict:"joinStrict",first:"joinLeading",last:"joinTrailing",all:"joinConcat"};b.exports=function(a){return function(){var b=d.call(arguments);return c({init:function(){var c=this[e[a]];c.apply(this,b.concat("trigger"))}})}}},{"./createStore":12}],19:[function(a,b,c){var d=c.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a};c.inherits=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=b},c.bindMethods=function(a,b){for(var c in a){var d=a[c];"function"==typeof d&&a.hasOwnProperty(c)&&(b[c]=d.bind(b))}},c.linkMethodsOf=function(a,b){var c={};for(var d in a){var e=a[d];if("function"==typeof e&&!c[d]){if("function"==typeof b[d])throw new Error("Cannot override API method "+d);b[d]=e.bind(a)}}},c.copyPropertiesOf=function(a,b){var c={};for(var d in a){var e=a[d];"function"!=typeof e&&"undefined"==typeof c[d]&&(b[d]=e)}},c.link=function(a,b){c.linkMethodsOf(a,b),c.copyPropertiesOf(a,b)},c.extend=function(a){if(!d(a))return a;for(var b,c,e=1,f=arguments.length;f>e;e++){b=arguments[e];for(c in b)a[c]=b[c]}return a},c.isFunction=function(a){return"function"==typeof a},c.isAction=function(a){return Boolean(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof a.trigger)},c.isPromise=function(a){return a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof a.then},c.EventEmitter=a("eventemitter3"),c.nextTick=function(a){setTimeout(a,0)},c.capitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},c.callbackName=function(a){return"on"+c.capitalize(a)},c.object=function(a,b){for(var c={},d=0;d<a.length;d++)c[a[d]]=b[d];return c},c.Promise=a("native-promise-only"),c.createPromise=function(a){return new c.Promise(a)},c.isArguments=function(a){return"object"==typeof a&&"callee"in a&&"number"==typeof a.length},c.throwIf=function(a,b){if(a)throw Error(b||a)}},{eventemitter3:1,"native-promise-only":2}]},{},[13])(13)});